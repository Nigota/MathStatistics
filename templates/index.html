<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Анализ спектроскопии пациентов</title>
    <script>
        // Инициализация графика с начальными данными
        const initialData = {{ initial_data|tojson|safe }};
        let currentData = initialData;
        let selectedWavenumber = null;
    </script>
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
    <script src="{{ url_for('static', filename='js/graphs.js') }}"></script>
    <link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet" type="text/css"/>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
<div class="control-panel">
    <h1>Параметры</h1>

    <div class="control-group">
        <label for="student-input">Student Number:</label>
        <input type="number" id="student-input" min="1" value="{{ initial_data.student_number }}" required>
        <div class="error-message" id="student-error">Должно быть целое число > 0</div>
    </div>

    <div class="control-group">
        <label for="step-input">Step:</label>
        <input type="number" id="step-input" min="1" value="{{ initial_data.step }}" required>
        <div class="error-message" id="step-error">Должно быть целое число > 0</div>
    </div>

    <button id="update-btn">
        Обновить данные
        <div class="button-spinner"></div>
    </button>

    <div class="ai-graph" id="ai-graph">
        <div class="ai-loading" id="ai-loading">
            <div class="spinner"></div>
        </div>
    </div>

    <div class="selected-point-info" id="selected-point-info">
        <p><strong>Выбранная точка:</strong></p>
        <p>Волновое число: <span id="selected-wavenumber">-</span> cm⁻¹</p>
    </div>

</div>

<div class="graph-container">
    <div class="graphs-wrapper">
        <div class="main-graph">
            <div id="graph" style="width:100%; height:90%;"></div>
            <div class="loading-overlay" id="graph-loading">
                <div class="spinner"></div>
            </div>
        </div>
        <div class="boxplot-container">
            <div id="boxplot" style="width:100%; height:100%;"></div>
            <div class="loading-overlay" id="boxplot-loading">
                <div class="spinner"></div>
            </div>
        </div>
    </div>
</div>
</body>
</html>